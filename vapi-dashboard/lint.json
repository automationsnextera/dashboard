[{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\app\\dashboard\\calls\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3229,3232],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3229,3232],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from \"@/utils/supabase/server\"\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { Separator } from \"@/components/ui/separator\"\r\nimport { ArrowLeft } from \"lucide-react\"\r\nimport Link from \"next/link\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\nexport default async function CallDetailsPage({\r\n    params,\r\n}: {\r\n    params: { id: string }\r\n}) {\r\n    const supabase = createClient()\r\n\r\n    const { data: call, error } = await supabase\r\n        .from('calls')\r\n        .select(`\r\n      *,\r\n      agents (\r\n        name\r\n      )\r\n    `)\r\n        .eq('id', params.id)\r\n        .single()\r\n\r\n    if (error || !call) {\r\n        return <div>Call not found</div>\r\n    }\r\n\r\n    // Parse transcript if possible\r\n    let transcriptMessages = []\r\n    try {\r\n        if (typeof call.transcript === 'string') {\r\n            transcriptMessages = JSON.parse(call.transcript)\r\n        } else if (Array.isArray(call.transcript)) {\r\n            transcriptMessages = call.transcript\r\n        }\r\n    } catch {\r\n        // Treat as plain text or failed\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex items-center gap-4\">\r\n                <Button variant=\"outline\" size=\"icon\" asChild>\r\n                    <Link href=\"/dashboard/calls\">\r\n                        <ArrowLeft className=\"h-4 w-4\" />\r\n                    </Link>\r\n                </Button>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold tracking-tight\">Call Details</h2>\r\n                    <p className=\"text-sm text-muted-foreground\">{call.id}</p>\r\n                </div>\r\n                <div className=\"ml-auto\">\r\n                    <Badge variant={call.status === 'active' ? 'default' : 'secondary'}>\r\n                        {call.status}\r\n                    </Badge>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 gap-6 md:grid-cols-3\">\r\n                {/* Main Content: Transcript and Audio */}\r\n                <div className=\"md:col-span-2 space-y-6\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle>Recording</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            {call.recording_url ? (\r\n                                <audio controls className=\"w-full\" src={call.recording_url}>\r\n                                    Your browser does not support the audio element.\r\n                                </audio>\r\n                            ) : (\r\n                                <div className=\"text-sm text-muted-foreground\">No recording available</div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle>Transcript</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-4\">\r\n                            {transcriptMessages.length > 0 ? (\r\n                                transcriptMessages.map((msg: any, index: number) => (\r\n                                    <div key={index} className={`flex flex-col ${msg.role === 'user' ? 'items-end' : 'items-start'}`}>\r\n                                        <div className={`px-4 py-2 rounded-lg max-w-[80%] ${msg.role === 'user' ? 'bg-primary text-primary-foreground' : 'bg-muted'}`}>\r\n                                            <p className=\"text-sm\">{msg.message || msg.content || msg.text}</p>\r\n                                        </div>\r\n                                        <span className=\"text-xs text-muted-foreground mt-1 capitalize\">{msg.role}</span>\r\n                                    </div>\r\n                                ))\r\n                            ) : (\r\n                                <div className=\"whitespace-pre-wrap text-sm\">\r\n                                    {typeof call.transcript === 'string' ? call.transcript : 'No transcript available'}\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n\r\n                {/* Sidebar: Analysis and Metadata */}\r\n                <div className=\"space-y-6\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle>Analysis</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-4\">\r\n                            <div>\r\n                                <h4 className=\"text-sm font-medium\">Summary</h4>\r\n                                <p className=\"text-sm text-muted-foreground mt-1\">\r\n                                    {call.summary || \"No summary available.\"}\r\n                                </p>\r\n                            </div>\r\n                            <Separator />\r\n                            <div>\r\n                                <h4 className=\"text-sm font-medium\">Sentiment</h4>\r\n                                <div className=\"mt-2 text-2xl\">\r\n                                    {/* Simple sentiment display */}\r\n                                    {call.sentiment ? (\r\n                                        <Badge>{call.sentiment}</Badge>\r\n                                    ) : (\r\n                                        <span className=\"text-sm text-muted-foreground\">--</span>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle>Metadata</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-2\">\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-sm text-muted-foreground\">Duration</span>\r\n                                <span className=\"text-sm font-medium\">{Math.floor((call.duration || 0) / 60)}m {Math.floor((call.duration || 0) % 60)}s</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-sm text-muted-foreground\">Cost</span>\r\n                                <span className=\"text-sm font-medium\">${(call.cost || 0).toFixed(4)}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-sm text-muted-foreground\">Agent</span>\r\n                                <span className=\"text-sm font-medium\">{call.agents?.name || 'Unknown'}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-sm text-muted-foreground\">Started At</span>\r\n                                <span className=\"text-sm font-medium\">{new Date(call.created_at).toLocaleString()}</span>\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle>Debug</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <pre className=\"text-xs bg-muted p-2 rounded overflow-auto max-h-40\">\r\n                                {JSON.stringify(call, null, 2)}\r\n                            </pre>\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\app\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CreditCard' is defined but never used.","line":3,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from \"@/utils/supabase/server\"\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Activity, CreditCard, DollarSign, Clock } from \"lucide-react\"\r\n\r\nexport default async function DashboardPage() {\r\n    const supabase = createClient()\r\n\r\n    // Fetch calls\r\n    // We limit to 1000 for aggregation for now, or could use count\r\n    const { data: calls, error, count } = await supabase\r\n        .from('calls')\r\n        .select('duration, cost, status', { count: 'exact' })\r\n        .order('created_at', { ascending: false })\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching dashboard data\", error)\r\n    }\r\n\r\n    const totalCalls = count || 0\r\n    const validCalls = calls || []\r\n\r\n    // Calculate stats\r\n    const totalCost = validCalls.reduce((acc, call) => acc + (call.cost || 0), 0)\r\n\r\n    // Calculate average duration (in seconds)\r\n    const totalDuration = validCalls.reduce((acc, call) => acc + (call.duration || 0), 0)\r\n    const avgDuration = totalCalls > 0 ? totalDuration / totalCalls : 0\r\n\r\n    // Format duration to mm:ss\r\n    const formatDuration = (seconds: number) => {\r\n        const min = Math.floor(seconds / 60)\r\n        const sec = Math.floor(seconds % 60)\r\n        return `${min}m ${sec}s`\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex items-center justify-between space-y-2\">\r\n                <h2 className=\"text-3xl font-bold tracking-tight\">Dashboard</h2>\r\n            </div>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">\r\n                            Total Calls\r\n                        </CardTitle>\r\n                        <Activity className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{totalCalls}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                            +0% from last month\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">\r\n                            Total Spend\r\n                        </CardTitle>\r\n                        <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">${totalCost.toFixed(2)}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                            +0% from last month\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">\r\n                            Avg. Duration\r\n                        </CardTitle>\r\n                        <Clock className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{formatDuration(avgDuration)}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                            +0% from last month\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\components\\dashboard\\calls\\columns.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ArrowUpDown' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MoreHorizontal' is defined but never used.","line":5,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":37}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport { ColumnDef } from \"@tanstack/react-table\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { ArrowUpDown, MoreHorizontal } from \"lucide-react\"\r\n\r\nexport type Call = {\r\n    id: string\r\n    status: \"active\" | \"completed\" | \"failed\" | \"voicemail\"\r\n    duration: number\r\n    cost: number\r\n    created_at: string\r\n    agent_id: string\r\n    agents?: {\r\n        name: string\r\n    }\r\n}\r\n\r\nexport const columns: ColumnDef<Call>[] = [\r\n    {\r\n        accessorKey: \"status\",\r\n        header: \"Status\",\r\n        cell: ({ row }) => {\r\n            const status = row.getValue(\"status\") as string\r\n\r\n            let variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" = \"default\"\r\n\r\n            switch (status) {\r\n                case \"active\":\r\n                    variant = \"default\" // Blue-ish primary\r\n                    break\r\n                case \"completed\":\r\n                    variant = \"secondary\" // Gray/Green depending on theme, maybe outline better\r\n                    break\r\n                case \"failed\":\r\n                    variant = \"destructive\"\r\n                    break\r\n                case \"voicemail\":\r\n                    variant = \"outline\"\r\n                    break\r\n                default:\r\n                    variant = \"outline\"\r\n            }\r\n\r\n            return (\r\n                <Badge variant={variant} className=\"capitalize\">\r\n                    {status}\r\n                </Badge>\r\n            )\r\n        },\r\n    },\r\n    {\r\n        accessorKey: \"agents.name\", // Assuming join\r\n        header: \"Agent\",\r\n        cell: ({ row }) => {\r\n            // Handle nested data if flattened or handle missing\r\n            const agentName = row.original.agents?.name || \"Unknown Agent\"\r\n            return <div className=\"font-medium\">{agentName}</div>\r\n        },\r\n    },\r\n    {\r\n        accessorKey: \"duration\",\r\n        header: \"Duration\",\r\n        cell: ({ row }) => {\r\n            const duration = parseFloat(row.getValue(\"duration\"))\r\n            if (isNaN(duration)) return \"-\"\r\n            const minutes = Math.floor(duration / 60)\r\n            const seconds = Math.floor(duration % 60)\r\n            return <div className=\"font-medium\">{`${minutes}m ${seconds}s`}</div>\r\n        },\r\n    },\r\n    {\r\n        accessorKey: \"cost\",\r\n        header: \"Cost\",\r\n        cell: ({ row }) => {\r\n            const amount = parseFloat(row.getValue(\"cost\"))\r\n            const formatted = new Intl.NumberFormat(\"en-US\", {\r\n                style: \"currency\",\r\n                currency: \"USD\",\r\n            }).format(amount)\r\n\r\n            return <div className=\"font-medium\">{formatted}</div>\r\n        },\r\n    },\r\n    {\r\n        accessorKey: \"created_at\",\r\n        header: \"Date\",\r\n        cell: ({ row }) => {\r\n            return (\r\n                <div className=\"text-muted-foreground text-sm\">\r\n                    {new Date(row.getValue(\"created_at\")).toLocaleString()}\r\n                </div>\r\n            )\r\n        },\r\n    },\r\n]\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\components\\dashboard\\calls\\data-table.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getPaginationRowModel' is defined but never used.","line":9,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":26},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":85,"column":41,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":85,"endColumn":54,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[3061,3074],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport {\r\n    ColumnDef,\r\n    flexRender,\r\n    getCoreRowModel,\r\n    useReactTable,\r\n    getPaginationRowModel,\r\n} from \"@tanstack/react-table\"\r\nimport { useRouter } from \"next/navigation\"\r\n\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\ninterface DataTableProps<TData, TValue> {\r\n    columns: ColumnDef<TData, TValue>[]\r\n    data: TData[]\r\n    pageCount?: number // For server-side pagination if needed\r\n    pageIndex?: number\r\n    pageSize?: number\r\n    onNextPage?: () => void\r\n    onPreviousPage?: () => void\r\n    hasNextPage?: boolean\r\n    hasPreviousPage?: boolean\r\n}\r\n\r\nexport function DataTable<TData, TValue>({\r\n    columns,\r\n    data,\r\n    onNextPage,\r\n    onPreviousPage,\r\n    hasNextPage,\r\n    hasPreviousPage\r\n}: DataTableProps<TData, TValue>) {\r\n    const router = useRouter()\r\n\r\n    const table = useReactTable({\r\n        data,\r\n        columns,\r\n        getCoreRowModel: getCoreRowModel(),\r\n        // Manual pagination is handled by parent, so we don't need getPaginationRowModel if purely server-side\r\n        // But if we pass all data, we use it. Here we assume server-side pagination logic passing chunks.\r\n        manualPagination: true,\r\n    })\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            <div className=\"rounded-md border\">\r\n                <Table>\r\n                    <TableHeader>\r\n                        {table.getHeaderGroups().map((headerGroup) => (\r\n                            <TableRow key={headerGroup.id}>\r\n                                {headerGroup.headers.map((header) => {\r\n                                    return (\r\n                                        <TableHead key={header.id}>\r\n                                            {header.isPlaceholder\r\n                                                ? null\r\n                                                : flexRender(\r\n                                                    header.column.columnDef.header,\r\n                                                    header.getContext()\r\n                                                )}\r\n                                        </TableHead>\r\n                                    )\r\n                                })}\r\n                            </TableRow>\r\n                        ))}\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                        {table.getRowModel().rows?.length ? (\r\n                            table.getRowModel().rows.map((row) => (\r\n                                <TableRow\r\n                                    key={row.id}\r\n                                    data-state={row.getIsSelected() && \"selected\"}\r\n                                    className=\"cursor-pointer hover:bg-muted/50\"\r\n                                    onClick={() => {\r\n                                        // Type assertion or check id\r\n                                        // @ts-ignore\r\n                                        const id = row.original.id\r\n                                        if (id) {\r\n                                            router.push(`/dashboard/calls/${id}`)\r\n                                        }\r\n                                    }}\r\n                                >\r\n                                    {row.getVisibleCells().map((cell) => (\r\n                                        <TableCell key={cell.id}>\r\n                                            {flexRender(cell.column.columnDef.cell, cell.getContext())}\r\n                                        </TableCell>\r\n                                    ))}\r\n                                </TableRow>\r\n                            ))\r\n                        ) : (\r\n                            <TableRow>\r\n                                <TableCell\r\n                                    colSpan={columns.length}\r\n                                    className=\"h-24 text-center\"\r\n                                >\r\n                                    No results.\r\n                                </TableCell>\r\n                            </TableRow>\r\n                        )}\r\n                    </TableBody>\r\n                </Table>\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-end space-x-2 py-4\">\r\n                <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={onPreviousPage}\r\n                    disabled={!hasPreviousPage}\r\n                >\r\n                    Previous\r\n                </Button>\r\n                <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={onNextPage}\r\n                    disabled={!hasNextPage}\r\n                >\r\n                    Next\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\components\\dashboard\\sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":10,"column":11,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":10,"endColumn":23,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[252,323],"text":"type SidebarProps = React.HTMLAttributes<HTMLDivElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport Link from \"next/link\"\r\nimport { usePathname } from \"next/navigation\"\r\nimport { LayoutDashboard, Phone, Users, Settings } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\ninterface SidebarProps extends React.HTMLAttributes<HTMLDivElement> { }\r\n\r\nexport function Sidebar({ className }: SidebarProps) {\r\n    const pathname = usePathname()\r\n\r\n    const routes = [\r\n        {\r\n            label: \"Dashboard\",\r\n            icon: LayoutDashboard,\r\n            href: \"/dashboard\",\r\n            active: pathname === \"/dashboard\",\r\n        },\r\n        {\r\n            label: \"Calls\",\r\n            icon: Phone,\r\n            href: \"/dashboard/calls\",\r\n            active: pathname.startsWith(\"/dashboard/calls\"),\r\n        },\r\n        {\r\n            label: \"Agents\",\r\n            icon: Users,\r\n            href: \"/dashboard/agents\",\r\n            active: pathname.startsWith(\"/dashboard/agents\"),\r\n        },\r\n        {\r\n            label: \"Settings\",\r\n            icon: Settings,\r\n            href: \"/dashboard/settings\",\r\n            active: pathname.startsWith(\"/dashboard/settings\"),\r\n        },\r\n    ]\r\n\r\n    return (\r\n        <div className={cn(\"pb-12\", className)}>\r\n            <div className=\"space-y-4 py-4\">\r\n                <div className=\"px-3 py-2\">\r\n                    <h2 className=\"mb-2 px-4 text-lg font-semibold tracking-tight\">\r\n                        Vapi Client\r\n                    </h2>\r\n                    <div className=\"space-y-1\">\r\n                        {routes.map((route) => (\r\n                            <Button\r\n                                key={route.href}\r\n                                variant={route.active ? \"secondary\" : \"ghost\"}\r\n                                className=\"w-full justify-start\"\r\n                                asChild\r\n                            >\r\n                                <Link href={route.href}>\r\n                                    <route.icon className=\"mr-2 h-4 w-4\" />\r\n                                    {route.label}\r\n                                </Link>\r\n                            </Button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\components\\ui\\input.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,158],"text":"type InputProps = React.InputHTMLAttributes<HTMLInputElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface InputProps\r\n    extends React.InputHTMLAttributes<HTMLInputElement> { }\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n    ({ className, type, ...props }, ref) => {\r\n        return (\r\n            <input\r\n                type={type}\r\n                className={cn(\r\n                    \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nInput.displayName = \"Input\"\r\n\r\nexport { Input }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\inngest\\functions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'step' is defined but never used.","line":14,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'agentError' is assigned a value but never used.","line":34,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":55}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { inngest } from \"@/inngest/client\"; // <--- Update this line\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n// ... rest of the file stays the same\r\n\r\n// Initialize Supabase with SERVICE ROLE key to bypass RLS\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport const processVapiEvent = inngest.createFunction(\r\n    { id: \"process-vapi-event\" },\r\n    { event: \"vapi/call.event\" },\r\n    async ({ event, step }) => {\r\n        // 1. Safe parsing of the incoming payload\r\n        const message = event.data.message || event.data;\r\n        const call = message.call;\r\n\r\n        if (!call || !call.id) {\r\n            console.error(\"âŒ No Call ID found in event\");\r\n            return { error: \"No call ID\" };\r\n        }\r\n\r\n        console.log(`ðŸ”„ Processing call: ${call.id}`);\r\n\r\n        // 2. Determine the Agent ID (Check payload, otherwise default to a test string)\r\n        // IMPORTANT: In production, Vapi always sends 'assistantId'.\r\n        const vapiAgentId = call.assistantId || \"YOUR_MANUAL_TEST_AGENT_ID\";\r\n\r\n        // 3. Find the Client in Supabase\r\n        let clientId = null;\r\n        let agentId = null;\r\n\r\n        const { data: existingAgent, error: agentError } = await supabase\r\n            .from(\"agents\")\r\n            .select(\"id, client_id\")\r\n            .eq(\"vapi_agent_id\", vapiAgentId)\r\n            .single();\r\n\r\n        if (existingAgent) {\r\n            clientId = existingAgent.client_id;\r\n            agentId = existingAgent.id;\r\n        } else {\r\n            console.warn(`âš ï¸ Agent ${vapiAgentId} not found. Attempting fallback to first Client.`);\r\n\r\n            // FALLBACK: Just for testing, grab the first client in the DB\r\n            const { data: fallbackClient } = await supabase\r\n                .from('clients')\r\n                .select('id')\r\n                .limit(1)\r\n                .single();\r\n\r\n            if (fallbackClient) {\r\n                clientId = fallbackClient.id;\r\n                // We leave agentId null if we can't find the specific agent\r\n            } else {\r\n                console.error(\"âŒ No Clients exist in DB. Cannot insert call.\");\r\n                return { error: \"No clients found\" };\r\n            }\r\n        }\r\n\r\n        // 4. Upsert the Call\r\n        const { error: upsertError } = await supabase\r\n            .from(\"calls\")\r\n            .upsert({\r\n                vapi_call_id: call.id,\r\n                client_id: clientId,\r\n                agent_id: agentId,\r\n                status: call.status || \"started\",\r\n                cost: call.cost || 0,\r\n                duration: (new Date(call.endedAt).getTime() - new Date(call.startedAt).getTime()) / 1000 || 0,\r\n                transcript: call.transcript || \"\",\r\n                recording_url: call.recordingUrl || \"\",\r\n                updated_at: new Date().toISOString(),\r\n            }, { onConflict: 'vapi_call_id' });\r\n\r\n        if (upsertError) {\r\n            console.error(\"âŒ Supabase Write Failed:\", upsertError);\r\n            throw new Error(upsertError.message);\r\n        }\r\n\r\n        console.log(`âœ… Success! Call ${call.id} saved for Client ${clientId}`);\r\n        return { success: true, callId: call.id };\r\n    }\r\n);","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CookieOptions' is defined but never used.","line":1,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":48},{"ruleId":"prefer-const","severity":2,"message":"'response' is never reassigned. Use 'const' instead.","line":5,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":5,"endColumn":17,"fix":{"range":[200,314],"text":"const response = NextResponse.next({\r\n        request: {\r\n            headers: request.headers,\r\n        },\r\n    });"}}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { createServerClient, type CookieOptions } from \"@supabase/ssr\";\r\nimport { NextResponse, type NextRequest } from \"next/server\";\r\n\r\nexport async function middleware(request: NextRequest) {\r\n    let response = NextResponse.next({\r\n        request: {\r\n            headers: request.headers,\r\n        },\r\n    });\r\n\r\n    const supabase = createServerClient(\r\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n        {\r\n            cookies: {\r\n                getAll() {\r\n                    return request.cookies.getAll();\r\n                },\r\n                setAll(cookiesToSet) {\r\n                    cookiesToSet.forEach(({ name, value, options }) => {\r\n                        request.cookies.set(name, value);\r\n                        response.cookies.set(name, value, options);\r\n                    });\r\n                },\r\n            },\r\n        }\r\n    );\r\n\r\n    await supabase.auth.getUser();\r\n\r\n    return response;\r\n}\r\n\r\nexport const config = {\r\n    matcher: [\r\n        /*\r\n         * Match all request paths except:\r\n         * - _next/static (static files)\r\n         * - _next/image (image optimization files)\r\n         * - favicon.ico (favicon file)\r\n         * - images - .svg, .png, .jpg, .jpeg, .gif, .webp\r\n         * Feel free to modify this pattern to include more paths.\r\n         */\r\n        \"/((?!_next/static|_next/image|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)\",\r\n    ],\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\haral\\Documents\\dashboard\\vapi-dashboard\\src\\utils\\supabase\\server.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":20,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createServerClient } from \"@supabase/ssr\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport const createClient = () => {\r\n  const cookieStore = cookies();\r\n\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        getAll() {\r\n          return cookieStore.getAll();\r\n        },\r\n        setAll(cookiesToSet) {\r\n          try {\r\n            cookiesToSet.forEach(({ name, value, options }) => {\r\n              cookieStore.set(name, value, options);\r\n            });\r\n          } catch (error) {\r\n            // The `set` method was called from a Server Component.\r\n            // This can be ignored if you have middleware refreshing\r\n            // user sessions.\r\n          }\r\n        },\r\n      },\r\n    }\r\n  );\r\n};\r\n","usedDeprecatedRules":[]}]